# TASK-0024: C-02 APIレスポンス契約統一

**タスクID**: TASK-0024
**タスクタイプ**: TDD
**推定工数**: 8時間
**フェーズ**: Phase 1 - Critical 修正
**信頼性レベル**: 🔵 *C-02: Backend モデルと Frontend 型定義の比較から確認*

## 関連文書

- **概要**: [📋 overview.md](overview.md)
- **要件定義**: [📋 requirements.md](../../spec/code-review-remediation/requirements.md) - REQ-CR-003
- **設計文書**: [📐 architecture.md](../../design/code-review-remediation/architecture.md)
- **API仕様**: [🔌 api-endpoints.md](../../design/code-review-remediation/api-endpoints.md)

## タスク概要

Backend の Pydantic レスポンスモデル (card.py, user.py) を正として、Frontend の TypeScript 型定義 (card.ts, user.ts) のフィールド名・型・Optional を合わせる。

## 依存タスク

- **前提タスク**: TASK-0023
- **後続タスク**: なし (Phase 1 内)

## 完了条件

- [ ] Frontend 型定義が Backend Pydantic モデルと完全に一致すること
- [ ] 型不一致によるコンパイルエラーがないこと
- [ ] 既存テストがパスすること
- [ ] テストがすべてパスすること
- [ ] 既存テストが壊れていないこと（回帰テスト）

---

## 実装詳細

1. 🔵 backend/src/models/card.py のフィールド定義を確認（正として扱う）
2. 🔵 backend/src/models/user.py のフィールド定義を確認（正として扱う）
3. 🔵 frontend/src/types/card.ts を Backend に合わせて修正
4. 🔵 frontend/src/types/user.ts を Backend に合わせて修正
5. 🟡 api.ts のレスポンス変換ロジックがあれば修正

---

## 単体テスト要件

- 🔵 型定義の一致をコンパイル時チェックで確認
- 🟡 APIレスポンスのフィールドマッピングが正しいことをテスト

---

## 実装手順

### TDDタスクの場合
1. `/tsumiki:tdd-requirements TASK-0024` - 詳細要件定義
2. `/tsumiki:tdd-testcases` - テストケース作成
3. `/tsumiki:tdd-red` - テスト実装（失敗）
4. `/tsumiki:tdd-green` - 最小実装
5. `/tsumiki:tdd-refactor` - リファクタリング
6. `/tsumiki:tdd-verify-complete` - 品質確認

---

## 注意事項

- OpenAPI スキーマ自動生成は使用しない（手動統一）
- 手動差分確認のため、Backend と Frontend の型を並べて比較する作業が必要

---

## 信頼性レベルサマリー

| カテゴリ | 🔵 青 | 🟡 黄 | 🔴 赤 | 合計 |
|---------|-------|-------|-------|------|
| 実装詳細 | 4 | 1 | 0 | 5 |
| 単体テスト | 1 | 1 | 0 | 2 |

**品質評価**: 大部分が🔵で信頼性が高い。🟡はレスポンス変換ロジックの有無に関する不確実性だが、影響は限定的。
