# code-review-fixes-v2 タスク概要

**作成日**: 2026-02-21
**プロジェクト期間**: 2026-02-21 - 2026-03-04（8日）
**推定工数**: 44時間
**総タスク数**: 6件

## 関連文書

- **要件定義書**: [📋 requirements.md](../../spec/code-review-fixes-v2/requirements.md)
- **設計文書**: [📐 architecture.md](../../design/code-review-fixes-v2/architecture.md)
- **API仕様**: [🔌 api-endpoints.md](../../design/code-review-fixes-v2/api-endpoints.md)
- **データフロー図**: [🔄 dataflow.md](../../design/code-review-fixes-v2/dataflow.md)
- **コンテキストノート**: [📝 note.md](../../spec/code-review-fixes-v2/note.md)

## フェーズ構成

| フェーズ | 期間 | 成果物 | タスク数 | 工数 | ファイル |
|---------|------|--------|----------|------|----------|
| Phase 1 | 2日 | Critical修正（API契約+データ整合性） | 2件 | 16h | [TASK-0042~0043](#phase-1-critical修正) |
| Phase 2 | 6日 | High修正（セキュリティ+設定統一） | 4件 | 28h | [TASK-0044~0047](#phase-2-high修正) |

## タスク番号管理

**使用済みタスク番号**: TASK-0042 ~ TASK-0047
**次回開始番号**: TASK-0048

## 全体進捗

- [ ] Phase 1: Critical修正（API契約整合性 + データ整合性）
- [ ] Phase 2: High修正（セキュリティ + レスポンスDTO + 通知 + 設定統一）

## マイルストーン

- **M1: Critical修正完了** (2日目): API契約統一 + card_countトランザクション修正完了
- **M2: High修正完了** (8日目): 全8件のレビュー指摘修正完了

---

## Phase 1: Critical修正

**期間**: 2日
**目標**: Critical(P0) 2件の修正完了
**成果物**: API契約3レイヤー整合性確保、card_countトランザクション安全性確保

### タスク一覧

- [x] [TASK-0042: APIルート統一（3レイヤー整合性修正）](TASK-0042.md) - 8h (TDD) 🔵
- [ ] [TASK-0043: card_countトランザクション修正](TASK-0043.md) - 8h (TDD) 🔵

### 依存関係

```
TASK-0042 と TASK-0043 は独立（並行実行可能）
TASK-0042 → TASK-0044（Phase 2）
```

---

## Phase 2: High修正

**期間**: 6日
**目標**: High(P1) 6件の修正完了
**成果物**: LINE連携セキュリティ強化、レスポンスDTO統一、通知タイムゾーン対応、設定値統一

### タスク一覧

- [ ] [TASK-0044: LINE連携本人性検証 + httpx統一](TASK-0044.md) - 8h (TDD) 🔵
- [ ] [TASK-0045: レスポンスDTO統一 + unlinkLine API使用](TASK-0045.md) - 8h (TDD) 🔵
- [ ] [TASK-0046: 通知時刻/タイムゾーン判定](TASK-0046.md) - 8h (TDD) 🔵
- [ ] [TASK-0047: 設定整合性統一（環境変数名・OIDCクライアントID）](TASK-0047.md) - 4h (DIRECT) 🔵

### 依存関係

```
TASK-0042 → TASK-0044 → TASK-0045
TASK-0046（独立）
TASK-0047（独立）
```

---

## 信頼性レベルサマリー

### 全タスク統計

- **総タスク数**: 6件
- 🔵 **青信号**: 6件 (100%)
- 🟡 **黄信号**: 0件 (0%)
- 🔴 **赤信号**: 0件 (0%)

### フェーズ別信頼性

| フェーズ | 🔵 青 | 🟡 黄 | 🔴 赤 | 合計 |
|---------|-------|-------|-------|------|
| Phase 1 | 2 | 0 | 0 | 2 |
| Phase 2 | 4 | 0 | 0 | 4 |

### タスク別詳細信頼性（全項目集計）

| タスク | 🔵 青 | 🟡 黄 | 🔴 赤 | 合計 |
|--------|-------|-------|-------|------|
| TASK-0042 | 12 | 0 | 0 | 12 |
| TASK-0043 | 15 | 2 | 0 | 17 |
| TASK-0044 | 15 | 2 | 0 | 17 |
| TASK-0045 | 13 | 0 | 0 | 13 |
| TASK-0046 | 14 | 3 | 0 | 17 |
| TASK-0047 | 5 | 0 | 0 | 5 |
| **合計** | **74** | **7** | **0** | **81** |

**全体品質評価**: ✅ 高品質（青信号91%、黄信号9%、赤信号0%）

## クリティカルパス

```
TASK-0042 → TASK-0044 → TASK-0045
```

**クリティカルパス工数**: 24時間（3日）
**並行作業可能工数**: 20時間（TASK-0043 + TASK-0046 + TASK-0047）

## 次のステップ

タスクを実装するには:
- 全タスク順番に実装: `/tsumiki:kairo-implement`
- 特定タスクを実装: `/tsumiki:kairo-implement TASK-0042`
